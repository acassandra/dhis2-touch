<!--
  Generated template for the DataEntryFormPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>Entry form</ion-title>
  </ion-navbar>

</ion-header>


<ion-content >
  <ion-grid>
    <ion-row>
      <ion-col>
        <div *ngIf="entryFormParameter" class="item-card" full (tap)="goBack()" padding-bottom padding-top>
          <div><b>Organisation Unit</b> : {{ entryFormParameter.orgUnit.name }}<br>
            <b>Form</b> : {{ entryFormParameter.dataSet.name }}<br>
            <b>Period</b> : {{ entryFormParameter.period.name }}
          </div>
        </div>
        <div *ngIf="isLoading">
          <page-loading [loadingMessage]="loadingMessage" [loadingSize]="'large'" ></page-loading>
        </div>
        <div *ngIf="!isLoading">
          <div *ngFor="let section of entryFormSections;let currentSectionIndex = index">
            <div *ngIf="(currentSectionIndex + 1) == pager.page" class="item-card" no-padding (click)="openSectionList()">
              <ion-item >
                <p ion-text color="font-color" no-padding align="center">
                  {{ section.name }}
                </p>
                <div style="text-align: center"item-right >
                  <span  float-end class="side-menu-icon">
                    <img [src]="icons.menu">
                  </span>
                </div>
              </ion-item>
            </div>
          </div>
          <div *ngFor="let section of entryFormSections;let currentSectionIndex = index">
            <div *ngIf="(currentSectionIndex + 1) == pager.page">
              <div class="item-card-entry-form" >
                <div class="entry-form-container" padding-bottom padding-top>
                  <div *ngFor="let dataElement of section.dataElements" >
                    <input-container [dataElement]="dataElement"
                                     [currentUser]="currentUser"
                                     (onChange)="updateData($event)"></input-container>
                  </div>
                </div>
              </div>

            </div>
          </div>

          <div class="item-card">
            <ion-row *ngIf="entryFormSections.length > 1" >
              <ion-col col-2 col-sm-1 (click)="changePagination(pager.page - 1)" padding-left padding-bottom padding-top>
                <ion-icon name="ios-arrow-back-outline" ></ion-icon>
              </ion-col>
              <ion-col  col-3 col-sm-2 padding-bottom padding-top>
                <div >
                  {{ pager.page + ' of ' + pager.total }}
                </div>
              </ion-col>
              <ion-col  col-2 col-sm-1 (click)="changePagination(pager.page  + 1)" padding-bottom padding-top>
                <ion-icon name="ios-arrow-forward-outline" ></ion-icon>
              </ion-col>
              <ion-col  col-5 col-sm-8 *ngIf="!isDataSetCompleted">
                <button color="favorite" round ion-button full [disabled] ="isDataSetCompletenessProcessRunning" (tap)="updateDataSetCompleteness()">
                  Complete
                </button>
              </ion-col>
              <ion-col  col-5 col-sm-8 *ngIf="isDataSetCompleted">
                <button  color="danger" round ion-button full [disabled] = "isDataSetCompletenessProcessRunning" (tap)="updateDataSetCompleteness()">
                  Undo Complete
                </button>
              </ion-col>
            </ion-row>


            <ion-row *ngIf="entryFormSections.length == 1">
              <ion-col  col-6 col-sm-6>

              </ion-col>
              <ion-col  col-6 col-sm-6>

              </ion-col>
            </ion-row>
          </div>

        </div>


      </ion-col>
    </ion-row>
  </ion-grid>



</ion-content>
